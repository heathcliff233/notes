# Chapter 02 插值法

## 2.2 Lagrange 插值

### 2.2.4 插值余项

* 罗尔定理

  如果函数 $f(x)$ 在闭区间 $[a,b]$ 上连续，在开区间 $(a,b)$ 内具有导数，且在区间端点的函数值相等，即 $f(a)=f(b)$ ，那么在 $(a,b)$ 内至少有一点 $\xi (a < \xi < b)$ ，使得函数 $f(x)$ 在该点的导数等于零：$f'(x)=0$

* Lagrange中值定理

  如果函数 $f(x)$ 在闭区间 $[a,b]$ 上连续，在开区间 $(a,b)$ 内具有导数，那么在 $(a,b)$ 内至少有一点 $\xi (a < \xi < b)$ ，使得等式 $f(b) - f(a) = (b - a)f'(\xi)$ 成立

* Lagrange插值法的插值余项

  设节点 $a \leq x_0 < x_1 < ... < x_n \leq b$ ，且 $f$ 满足条件 $f \in C^n[a,b]$ ，$f^{(n+1)}$  在 $[a,b]$ 内存在(!重要，高阶导数存在)，截断误差（插值余项）：
  $$
  R_n(x) = f(x)-L_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x) \ \ , \xi \in (a,b)  \\
  \omega_{n+1}(x) = (x-x_0)(x-x_1)...(x-x_n)
  $$
  



## 2.3 差商与牛顿插值公式

### 2.3.1 差商的定义及性质

* 定义： $f(x)$ 关于 $x_0,x_1,...,x_n$ 的n级差商：

$$
f[x_0,x_1,...,x_n] = \frac{f[x_1,x_2,...,x_n]-f[x_0,x_1,...,x_{n-1}]}{x_n - x_0}  \\
f[x_i,x_{i+1}] = \frac{f[x_{i+1}]-f[x_i]}{x_{i+1}-x_{i}}  \\
f[x_i] \rightarrow f(x)\ zero\ grade
$$

* 性质：

  - 差商可表示为函数值的线性组合，即

    $f[x_0,x_1,...,x_n] = \sum_{j=0}^n \frac{f(x_j)}{(x_j-x_0)...(x_j-x_{j-1})(x_j-x_{j+1})...(x_j-x_n)}$

  - 差商关于所含节点对称

    $f[x_0,x_1,...,x_n] = f[x_1,x_0,...,x_n] = ...$

  - 同定义

  - 设 $f(x)$ 在 $[a,b]$ 存在n阶导数，且 $x_0,x_1,...,x_n \in [a,b]$ ，则 $\exists \xi \in (a,b)$ ，使得

    $f[x_0,x_1,...,x_n] = \frac{f^{(n)}(\xi)}{n!}$



### 2.3.2 牛顿插值公式

把x看作 $[a,b]$ 上的一点，可得
$$
f(x) = f(x_0) + f[x,x_0](x-x_0)  \\
f[x,x_0] = f[x_0,x_1] + f[x,x_0,x_1](x-x_1)  \\
...  \\
f[x,x_0,x_1,...,x_{n-1}] = f[x_0,x_1,...,x_n] + f[x,x_0,x_1,...,x_n](x-x_n)
$$
回带
$$
f(x) =  f(x_0) + f[x_0,x_1](x-x_0)  \\
+ f[x_0,x_1,x_2](x-x_0)(x-x_1)+...  \\
+ f[x_0,x_1,x_2,...,x_n](x-x_0)...(x-x_{n-1})  \\
+ f[x,x_0,x_1,...,x_n]\omega_{n+1}(x)  \\
=N_n(x)+R_n(x)  \\
R_n(x) = f[x,x_0,x_1,...,x_n]\omega_{n+1}(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)...(x-x_n)
$$
 $N(x)$ 为牛顿插值多项式